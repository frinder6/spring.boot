实现参照：http://blog.csdn.net/u010359884/article/details/50310387